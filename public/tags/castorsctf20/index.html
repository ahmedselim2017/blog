<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>castorsCTF20 :: Blog</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="" />
<meta name="keywords" content="blog" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="/tags/castorsctf20/" />




<link rel="stylesheet" href="/assets/style.css">

  <link rel="stylesheet" href="/assets/blue.css">






<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">

  <link rel="shortcut icon" href="/img/favicon/blue.png">



<meta name="twitter:card" content="summary" />

  <meta name="twitter:site" content="" />

<meta name="twitter:creator" content="" />


<meta property="og:locale" content="en" />
<meta property="og:type" content="website" />
<meta property="og:title" content="castorsCTF20 :: Blog">
<meta property="og:description" content="" />
<meta property="og:url" content="/tags/castorsctf20/" />
<meta property="og:site_name" content="castorsCTF20" />

  
    <meta property="og:image" content="/img/favicon/blue.png">
  

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">





  <link href="/tags/castorsctf20/index.xml" rel="alternate" type="application/rss+xml" title="Blog" />









</head>
<body class="">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Ahmed Selim Üzüm
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="https://github.com/ahmedselim2017">Github</a></li>
        
      
        
          <li><a href="/writups">CTF Writups</a></li>
        
      
      
    

    
    <div class="spacer"></div>
    <ul class="language-selector">
      <ul class="language-selector-current">
          <li>English ▾</li>
      </ul>
      <ul class="language-selector__more hidden">
        
        <li><a href="/">English</a></li>
        
        <li><a href="/tr/">Türkçe</a></li>
        
      </ul>
    </ul>
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="https://github.com/ahmedselim2017">Github</a></li>
      
    
      
        <li><a href="/writups">CTF Writups</a></li>
      
    
    
    <hr />
        
          <li>
            <a href="/">English</a>
          </li>
        
          <li>
            <a href="/tr/">Türkçe</a>
          </li>
        
    
  </ul>
</nav>

  
</header>


  <div class="content">
    

<div class="posts">
  
  

  
  
  

  
  <div class="post on-list">
    <h1 class="post-title">
      <a href="/writups/castorsctf20/abcbof/">abcbof</a></h1>
    <div class="post-meta">
      <span class="post-date">
        0001-01-01
      </span>
      <span class="post-author">::
        tozkoparan (Ahmed Selim Üzüm)</span>
    </div>

    
    <span class="post-tags">
      
      #<a href="/tags/writeup/">writeup</a>&nbsp;
      
      #<a href="/tags/pwn/">pwn</a>&nbsp;
      
      #<a href="/tags/castorsctf20/">castorsCTF20</a>&nbsp;
      
    </span>
    

    

    <div class="post-content">
      
      
      The executable file wants a password from us. So let’s see if it uses strcmp for comparing it. If that, and the text isn’t encyripted we should able to see the password. So let’s run ltrace ./abcbof and give aaaa for password. Here is the password! But when we tried it, it didn’t work.
We can use ghidra for seeing why it didn’t work.
undefined8 main(void) { int iVar1; char local_118 [256]; char local_18 [16]; printf(&quot;Hello everyone, say your name: &quot;); gets(local_118); iVar1 = strcmp(&quot;CyberCastors&quot;,local_18); if (iVar1 == 0) { get_flag(); } puts(&quot;You lose!
      
      
    </div>

    
    <div>
      <a class="read-more button"
        href="/writups/castorsctf20/abcbof/">Read more →</a>
    </div>
    
  </div>
  
  <div class="post on-list">
    <h1 class="post-title">
      <a href="/writups/castorsctf20/arithmetics/">Arithmetics</a></h1>
    <div class="post-meta">
      <span class="post-date">
        0001-01-01
      </span>
      <span class="post-author">::
        tozkoparan (Ahmed Selim Üzüm)</span>
    </div>

    
    <span class="post-tags">
      
      #<a href="/tags/writeup/">writeup</a>&nbsp;
      
      #<a href="/tags/coding/">Coding</a>&nbsp;
      
      #<a href="/tags/castorsctf20/">castorsCTF20</a>&nbsp;
      
    </span>
    

    

    <div class="post-content">
      
      
      When we connect to the server, we can see we have to answer a lot of questions. So that let’s write a script!
from pwn import * conn = remote(&quot;chals20.cybercastors.com&quot;,14429) conn.recvuntil(&quot;&lt;&quot;) conn.recvuntil(&quot;\n&quot;) conn.send(&quot;\n&quot;) sayilar = {&quot;one&quot;:1, &quot;two&quot;:2, &quot;three&quot;:3, &quot;four&quot;:4, &quot;five&quot;:5, &quot;six&quot;:6, &quot;seven&quot;:7, &quot;eight&quot;:8, &quot;nine&quot;:9, &quot;zero&quot;:0} while True: try: soru = conn.recvline() print(soru) soru = str(soru).split(&quot; &quot;) try: sayi1 = int(soru[2]) except: sayi1 = sayilar[soru[2]] try: sayi2 = int(soru[4]) except: sayi2 = sayilar[soru[4]] if soru[3] == '+' or soru[3] == &quot;plus&quot;: islem = &quot;+&quot; sonuc = sayi1 + sayi2 elif soru[3] == '-' or soru[3] == &quot;minus&quot;: islem = &quot;-&quot; sonuc = sayi1 - sayi2 elif soru[3] == '<em>' or soru[3] == &quot;multiplied-by&quot;: islem = &quot;</em>&quot; sonuc = sayi1 * sayi2 elif soru[3] == '//' or soru[3] == &quot;divided-by&quot;: islem = &quot;/&quot; sonuc = sayi1 // sayi2 conn.
      
      
    </div>

    
    <div>
      <a class="read-more button"
        href="/writups/castorsctf20/arithmetics/">Read more →</a>
    </div>
    
  </div>
  
  <div class="post on-list">
    <h1 class="post-title">
      <a href="/writups/castorsctf20/babybof1/">babybof1</a></h1>
    <div class="post-meta">
      <span class="post-date">
        0001-01-01
      </span>
      <span class="post-author">::
        tozkoparan (Ahmed Selim Üzüm)</span>
    </div>

    
    <span class="post-tags">
      
      #<a href="/tags/writeup/">writeup</a>&nbsp;
      
      #<a href="/tags/pwn/">pwn</a>&nbsp;
      
      #<a href="/tags/castorsctf20/">castorsCTF20</a>&nbsp;
      
    </span>
    

    

    <div class="post-content">
      
      
      
    </div>

    
    <div>
      <a class="read-more button"
        href="/writups/castorsctf20/babybof1/">Read more →</a>
    </div>
    
  </div>
  
  <div class="post on-list">
    <h1 class="post-title">
      <a href="/writups/castorsctf20/babybof2/">babybof2</a></h1>
    <div class="post-meta">
      <span class="post-date">
        0001-01-01
      </span>
      <span class="post-author">::
        tozkoparan (Ahmed Selim Üzüm)</span>
    </div>

    
    <span class="post-tags">
      
      #<a href="/tags/writeup/">writeup</a>&nbsp;
      
      #<a href="/tags/pwn/">pwn</a>&nbsp;
      
      #<a href="/tags/castorsctf20/">castorsCTF20</a>&nbsp;
      
    </span>
    

    

    <div class="post-content">
      
      
      
    </div>

    
    <div>
      <a class="read-more button"
        href="/writups/castorsctf20/babybof2/">Read more →</a>
    </div>
    
  </div>
  
  <div class="post on-list">
    <h1 class="post-title">
      <a href="/writups/castorsctf20/bane_art/">Bane Art</a></h1>
    <div class="post-meta">
      <span class="post-date">
        0001-01-01
      </span>
      <span class="post-author">::
        tozkoparan (Ahmed Selim Üzüm)</span>
    </div>

    
    <span class="post-tags">
      
      #<a href="/tags/writeup/">writeup</a>&nbsp;
      
      #<a href="/tags/web/">web</a>&nbsp;
      
      #<a href="/tags/castorsctf20/">castorsCTF20</a>&nbsp;
      
    </span>
    

    

    <div class="post-content">
      
      
      When we inspect the site we can see it uses topic param for getting the topig. And it looks like it includes the topic file. But can we use it for LFI? YES! We can test it with setting topic to /etc/passwd.
With changing our user agent to &lt;?php system($_GET[&lsquo;cmd&rsquo;]);?&gt; and reading /var/log/apache2/access.log file we can execute any command we want using CMD param. Then with setting CMD to ls -Rla we can see flag is inside /home/falg/flag/test/why/the/hassle/right/flag.
      
      
    </div>

    
    <div>
      <a class="read-more button"
        href="/writups/castorsctf20/bane_art/">Read more →</a>
    </div>
    
  </div>
  
  <div class="pagination">
  <div class="pagination__buttons">
    
    
      <span class="button next">
        <a href="/tags/castorsctf20/page/2/">
          <span class="button__text">Older posts</span>
          <span class="button__icon">→</span>
        </a>
      </span>
    
  </div>
</div>

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user">
        <span>Ahmed Selim Üzüm</span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>





  
</div>

</body>
</html>
